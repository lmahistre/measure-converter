# Measure Converter

## Usage

This addon instantly converts measurements from and to different units:
* Length: centimeters and inches
* Weight: kilograms and pounds
* Temperature: Celsius and Farenheit

It is possible to display the converter in a separate window to avoid losing converted data.

## Build and development

### Requirements

* NodeJS version 8 or higher
* NPM vresion 6 or higher

### Structure of the project

Source files for Javascript and CSS are in the folder `src`. Folder `server` contains all the scripts neccesary to build the web page and the Firefox addon.

The Javascript of the addon is built using [Webpack](https://webpack.js.org) and [React](https://reactjs.org).

CSS is built using [LESS](https://lesscss.org).

The Measure Converter application can be used either as a Firefox addon or as a web page. The only difference between the two versions is the Service Worker on the web page.

Files generated during build are in the two folders:
* `addon` contains the files for the Firefox addon. This is the only folder used to package the addon. This folders contains:
  * folder `img` containing all the logos and images
  * `app.js`: the Javascript bundle generated with Webpack. The entry point used by Webpack is `src/js/entry-addon.js`
  * `index.html`: this file is also generated
  * `manifest.json`: manifest used by Firefox to run the addon
  * `style.css` style made from LESS files
* `public` contains the files to use the app as a web page. This folder is mainly present for develoment purpose but it can also be used to run the application as a web page instead of an addon. This folder contains:
  * folder `img` containing all the logos and images
  * `app.js`: the Javascript bundle generated by Webpack. The entry point used by Webpack is `src/js/entry-site.js`
  * `index.html`
  * `manifest.json`: Web App manifest
  * `style.css` style made from LESS files
  * `sw.js` is a static file used as a service worker. It is not generated during build.

### Development

First, install dependencies:

`npm install`

To compile Javascript and CSS files for the web page:

`npm run dev`

To compile Javascript for both the addon and the web page:

`npm run js`

To compile CSS for both the addon and the web page:

`npm run css`

To launch unit tests:

`npm test`

To build Javascript and CSS files for production (addon and site), then launch unit tests:

`npm run build`

### Publishing

First, install dependencies:

`npm install`

Before developing or publishing, it is possible to remove the entire `addon` folder and the content of `public` (except sw.js), those files are going to be re-generated. If they are not removed they will be overwritten.

To build the application and create Zip files containing the addon code and source code, run:

`npm run publish`

This action generates all the files in `addon` and `public` folders (`app.js`, `style.css`, `index.html`, `manifest.json` and images), then creates two zip files:
* `main.zip`: the zip file containing the code of the Firefox addon. It is only made with the content of the folder `addon`. This file is uploaded on Mozilla website to create the .xpi file.
* `source.zip`: the zip file containing the source code. It contains all the content of the development repository, and also the files generated in folders `public` and `addon` are included as an example of generated files. This file is uploaded on Mozilla website to provide the source code.

The package for the addon is made from folder `addon`, which contains static files, manifest and html.

## Languages

Documentation is also available in French [here](README.fr.md).
